\chapter{Discussion} \label{discussion}

Correctness
Strong Consistency
Efficiency - update log is very inefficient
Store all peers since finite size of network?
No protection against brute force attacks on network IP/port 

Logical p2p, cannot prove or guarantee that the electrons from one producer ends up at the consumer of which it has a smart contract with. Consumers pay the producer for the electricity they have consumed and the producer produced, even if it is not the exact same electricity.

advantages of building own blockchain and smart contract system is that it ensure zero transactional fees in the system. more control over data?
disadvantages include maintenance of code and documentation, more work trough implementation and testing

settlement and storage in parallel. use transaction blockchain to audit that settlements done right, immutable properties ensures correct information

What differs in this solution, compared to the other solutions from the background chapter?
DESCRIBE SHORTCOMINGS IN SYSTEM IN RELATION TO DESIGN
 - Communication: open connection between all nodes, limit to e.g. 5 and broadcast numbered messages until all nodes have received them. 
 - Consensus: limit consensus nodes to only 5. 
 
Reasons for RAFT

Discuss how the functional specs are satisfied or not, refer to by number

Space saving - delete smart contracts that are no longer valid. 

What sets this system apart from many of the other related systems, is that there are no tokens.

%diskusjon: tolke resultat, konstantere at det virker og performance - fotavtrykk (størrelse på kjede, hvor lang tid det tar)
%e.g. hvor lang tid tar det å få 1000 transaksjoner. diskusjon - nytt felt, enorme utviklinger bare under oppgave. Det jeg har gjort har lært meg mye
%å bruke noe som er ferdig vil gjøre at man kommer fortere til målet
%Ting andre lager blir vedlikeholdt
%hva virket - hva fikk man ikke tid til - hva ønsker man skulle vært anerledes/Bedre --> videre arbeid (Begrunnelse)
%På slutt av diskusjon - oppsummering av videre arbeid - bullet points

%Kritisk blikk på eget arbeid - spesielt relatert til utviklinger
%år kutter man en kjede og begynner på nytt - 3 års horisont- etter 4 år slettes første år

RAFT is not PBFT. Anyone can establish themselves as leader and start sending out \textit{AppendEntries} messages. In the presence of Byzantine nodes in the system, this is not suitable. By making new users part of the validation process, the risk is reduced. Since this system is implemented in a restricted physical area, where participants are neighbors and possibly acquaintances, the risk of Byzantine nodes is reduced even further.

\section{Privacy}

%Krypto - privat
%personvern - misbruk av ams - data bare tolket av de som er involvert i kjeden
%Private nøkler, misting - et avsnitt om vern av privatdata i diskusjon
%Diskusjon teknisk at det virker, er folk villige til å ta implementasjonen i bruk (personvern) - salg av data til firma - kriminelle ser når huset er tomt


\section{Future Work}
Current implementation stores blockchain and other logs locally on machine, a future improvement could be to store the data in the cloud to save space.

To save space, blocks containing transactions that are settled or smart contracts that are no longer valid can be deleted. 

Make new users part of validation - to ensure true consortium. Current solution can be attacked through brute force, since the only requirement to join is to know the IP address and port number of an existing node on the network.

Automatic selection of who to initiate smart contract with for consumer based on pre-defined constraints 

Only some nodes part of validation? and let these have open connections to each other, let remaining nodes have connections to at least one of the validation nodes. 

Merkel trees for scalability. Is there a point though, since merkel trees are for time saving (?) and we are not iterating through blockchain to find previous transactions. Maybe usable in smart contract blockchain

Increase BFT by signing messages to prove authenticity. 

Automatic smart contract based on pre-set prices given by prosumer and consumer

Settlement - better algorithm - including taking electricity from batteries for better flow